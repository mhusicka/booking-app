<div style="margin-top: 30px; padding-top: 20px; border-top: 1px dashed #ddd;">
        <h3 style="font-size: 0.9rem; color: #888; text-transform: uppercase; margin-bottom: 10px;">
            Máte již rezervaci?
        </h3>
        <div style="display: flex; gap: 10px;">
            <input type="text" id="inp-retrieve-code" placeholder="Kód rezervace (např. X7A2P9)" 
                   style="text-transform: uppercase; letter-spacing: 1px;">
            <button onclick="retrieveBooking()" class="btn-small" style="background: #fff; border: 1px solid #333; color: #333;">
                NAJÍT
            </button>
        </div>
        <p style="font-size: 0.75rem; color: #aaa; margin-top: 5px;">
            Zadejte kód rezervace, který se zobrazil po zaplacení, pro opětovné zobrazení PINu.
        </p>
    </div>

</div> ```

---

### 3. Frontend: `script.js`
Zde musíme upravit funkci `submitReservation` (přidat nové parametry do URL) a přidat funkci `retrieveBooking`.

```javascript
// ... (začátek souboru script.js beze změny) ...

// Přidejte tuto novou funkci na konec souboru nebo někam mezi funkce
async function retrieveBooking() {
    const codeInput = document.getElementById("inp-retrieve-code");
    const code = codeInput.value.trim();
    const btn = codeInput.nextElementSibling; // tlačítko vedle inputu

    if (!code) { alert("Zadejte prosím kód rezervace."); return; }

    btn.innerText = "...";
    btn.disabled = true;

    try {
        const res = await fetch(`${API_BASE}/retrieve-booking`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ orderId: code })
        });
        const result = await res.json();

        if (result.success) {
            // Přesměrujeme na success stránku s načtenými daty
            const params = new URLSearchParams({
                pin: result.pin,
                start: result.start,
                end: result.end,
                time: result.time,
                orderId: result.orderId,
                restored: "true" // příznak, že jde o obnovení
            });
            window.location.href = `success.html?${params.toString()}`;
        } else {
            alert("Chyba: " + (result.error || "Rezervace nenalezena"));
        }
    } catch (e) {
        alert("Chyba komunikace se serverem.");
    } finally {
        btn.innerText = "NAJÍT";
        btn.disabled = false;
    }
}

// ...

// UPRAVTE FUNKCI submitReservation takto:
async function submitReservation() {
    const agreeCheckbox = document.getElementById("inp-agree");
    if (!agreeCheckbox || !agreeCheckbox.checked) {
        alert("Pro provedení rezervace musíte souhlasit se smluvními podmínkami.");
        return;
    }
    // ... (validace polí name, email atd. beze změny) ...
    // ...

    const btn = document.querySelector(".btn-pay");
    btn.innerText = "Generuji přístup...";
    btn.disabled = true;

    try {
        const res = await fetch(`${API_BASE}/reserve-range`, {
            method: "POST", headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ startDate, endDate, time, name, email, phone })
        });
        const result = await res.json();

        if (result.success) {
            // ÚPRAVA: Předáváme orderId a emailStatus
            const params = new URLSearchParams({
                pin: result.pin,
                start: startDate,
                end: endDate,
                time: time,
                orderId: result.orderId,      // <--- NOVÉ
                emailStatus: result.emailStatus // <--- NOVÉ (z předchozího kroku)
            });
            window.location.href = `success.html?${params.toString()}`;
        } else {
            alert("Chyba: " + (result.error || "Neznámá chyba"));
            btn.innerText = "REZERVOVAT A ZAPLATIT"; 
            btn.disabled = false;
        }
    } catch (e) { 
        alert("Chyba komunikace."); 
        btn.innerText = "REZERVOVAT A ZAPLATIT"; 
        btn.disabled = false;
    } 
}
