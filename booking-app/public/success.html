<div class="success-box">
    
    <div id="email-warning" style="display:none; background: #fff3cd; color: #856404; padding: 15px; margin-bottom: 20px; border: 1px solid #ffeeba; border-radius: 5px; text-align: left; font-size: 0.9rem;">
        <strong>⚠️ POZOR: Email se nepodařilo odeslat!</strong><br>
        Opište si prosím <strong>Kód rezervace</strong> a <strong>PIN</strong> níže.
    </div>

    <div class="icon-check">✔</div>
    <h1 id="success-title">Rezervace úspěšná!</h1>
    
    <div style="background: #f0f0f0; padding: 10px; border-radius: 4px; margin-bottom: 20px; font-size: 0.9rem; color: #555;">
        Kód rezervace pro zpětné dohledání:<br>
        <strong id="display-order-id" style="font-size: 1.4rem; color: #333; letter-spacing: 2px;">------</strong>
    </div>

    <p id="success-msg">Děkujeme. Váš přívěsný vozík je rezervován.</p>

    <div class="pin-display">
        <span class="pin-label">Váš kód k zámku</span>
        <span id="display-pin" class="pin-number">------</span>
    </div>

    <div class="details">
        <strong>Termín rezervace:</strong><br>
        <span id="display-date">Načítám...</span>
    </div>

    <a href="/" class="btn-pay" style="text-decoration: none; display: inline-block; width: auto; padding: 15px 40px;">Zpět na úvod</a>
</div>

<script>
    const params = new URLSearchParams(window.location.search);
    
    const pin = params.get("pin");
    const start = params.get("start");
    const end = params.get("end");
    const time = params.get("time");
    const orderId = params.get("orderId");      // NOVÉ
    const emailStatus = params.get("emailStatus"); // NOVÉ
    const restored = params.get("restored"); // NOVÉ

    if (pin) document.getElementById("display-pin").innerText = pin;
    
    // Zobrazení kódu rezervace
    if (orderId) document.getElementById("display-order-id").innerText = orderId;

    // Logika pro zobrazení varování nebo změnu textů
    if (emailStatus === "failed") {
        document.getElementById("email-warning").style.display = "block";
    }

    if (restored === "true") {
        document.getElementById("success-title").innerText = "Detail rezervace";
        document.getElementById("success-msg").style.display = "none";
        document.querySelector(".icon-check").style.display = "none";
    }

    if (start && end && time) {
        const format = (d) => new Date(d).toLocaleDateString("cs-CZ");
        document.getElementById("display-date").innerHTML = 
            `${format(start)} ${time} &nbsp;—&nbsp; ${format(end)} ${time}`;
    }
</script>
